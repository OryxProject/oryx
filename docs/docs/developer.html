
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2017-09-06
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Oryx &#x2013; Docs: Dev</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="../css/bootswatch.css" rel="stylesheet" />
		<link href="../css/reflow-skin.css" rel="stylesheet" />


		<link href="../css/lightbox.css" rel="stylesheet" />

		<link href="../css/site.css" rel="stylesheet" />
		<link href="../css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->



	</head>

	<body class="page-docs-developer project-oryx" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="../index.html">Oryx 2</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="../index.html" title="Overview">Overview</a></li>
							<li ><a href="endusers.html" title="Docs: End Users">Docs: End Users</a></li>
							<li class="active"><a href="" title="Docs: Dev">Docs: Dev</a></li>
							<li ><a href="admin.html" title="Docs: Admin">Docs: Admin</a></li>
							<li ><a href="performance.html" title="Performance">Performance</a></li>
							<li ><a href="../apidocs/index.html" title="Javadoc">Javadoc</a></li>
							<li ><a href="https://github.com/OryxProject/oryx" title="GitHub" class="externalLink">GitHub</a></li>
							<li ><a href="https://github.com/OryxProject/oryx/releases" title="Download" class="externalLink">Download</a></li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="page-header">
 <h1 id="building_from_source">Building from Source</h1>
</div> 
<div class="section"> 
 <h2 id="Requirements">Requirements</h2> 
 <ul> 
  <li><a class="externalLink" href="https://git-scm.com/">Git</a>, or an IDE that supports Git</li> 
  <li><a class="externalLink" href="https://maven.apache.org/">Apache Maven</a> 3.2.5 or later</li> 
  <li><a class="externalLink" href="http://openjdk.java.net/projects/jdk8/">Java JDK</a> (not just JRE) 8 or later</li> 
 </ul> 
 <p>Some or all of these may already be installed on your development machine.</p> 
</div> 
<div class="section"> 
 <h2 id="Building">Building</h2> 
 <p>Clone the repository in your desired local directory and build it:</p> 
 <div class="source"> 
  <div class="source"> 
   <pre>git clone https://github.com/OryxProject/oryx.git oryx
cd oryx
mvn -DskipTests package
</pre> 
  </div> 
 </div> 
 <p>This will build the following binaries:</p> 
 <ul> 
  <li>Batch Layer: <tt>deploy/oryx-batch/target/oryx-batch-2.5.0.jar</tt></li> 
  <li>Speed Layer: <tt>deploy/oryx-speed/target/oryx-speed-2.5.0.jar</tt></li> 
  <li>Serving Layer: <tt>deploy/oryx-serving/target/oryx-serving-2.5.0.jar</tt></li> 
 </ul> 
 <p>Note that if you are interested in developing on Oryx, you should probably <a class="externalLink" href="https://help.github.com/articles/fork-a-repo">fork this repository</a> and then work on your own fork, so that you can submit pull requests with changes.</p> 
 <div class="section"> 
  <h3 id="Platform_Only">Platform Only</h3> 
  <p>The default build includes end-to-end ML applications based on Spark MLlib and other libraries. To build only the lambda tier and ML tier, for use with your own app, disable the <tt>app-tier</tt> profile: <tt>-P!app-tier</tt>. Note that in <tt>bash</tt>, <tt>!</tt> is reserved, so you may need to add <tt>-P\!app-tier</tt>.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Testing">Testing</h2> 
 <p><tt>mvn test</tt> runs all unit tests. <tt>mvn verify</tt> will run all integration tests too, which takes significantly longer.</p> 
 <h1 id="module_mapping">Module Mapping</h1> 
 <p>Major modules and their relation to tiers and layers:</p> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="a"> 
    <th align="right"> </th> 
    <th><i>Serving</i> </th> 
    <th><i>Speed</i> </th> 
    <th><i>Batch</i> </th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td align="right"><i>Binary</i> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/deploy/oryx-serving"><tt>oryx-serving</tt></a> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/deploy/oryx-speed"><tt>oryx-speed</tt></a> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/deploy/oryx-batch"><tt>oryx-batch</tt></a> </td> 
   </tr> 
   <tr class="a"> 
    <td align="right"><i>App</i> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/oryx-app-serving"><tt>oryx-app-serving</tt></a> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/oryx-app-mllib"><tt>oryx-app-mllib</tt></a> <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/oryx-app"><tt>oryx-app</tt></a> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/oryx-app-mllib"><tt>oryx-app-mllib</tt></a> <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/oryx-app"><tt>oryx-app</tt></a> </td> 
   </tr> 
   <tr class="b"> 
    <td align="right"><i>ML</i> </td> 
    <td> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/framework/oryx-ml"><tt>oryx-ml</tt></a> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/framework/oryx-ml"><tt>oryx-ml</tt></a> </td> 
   </tr> 
   <tr class="a"> 
    <td align="right"><i>Lambda</i> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/framework/oryx-lambda-serving"><tt>oryx-lambda-serving</tt></a> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/framework/oryx-lambda"><tt>oryx-lambda</tt></a> </td> 
    <td><a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/framework/oryx-lambda"><tt>oryx-lambda</tt></a> </td> 
   </tr> 
  </tbody> 
 </table> 
 <p>Supporting modules like <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/framework/oryx-common"><tt>oryx-common</tt></a>, <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/oryx-app-common"><tt>oryx-app-common</tt></a>, <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/framework/oryx-api"><tt>oryx-api</tt></a>, and <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/oryx-app-api"><tt>oryx-app-api</tt></a> are not shown.</p> 
 <h1 id="making_an_oryx_app">Making an Oryx App</h1> 
 <p>Oryx comes with an “app tier”, implementations of actual Batch, Speed and Serving Layer logic for recommendation, clustering and classification. However, any implementation may be used with Oryx. They can be mixed and matched too. For example, you could reimplement the Batch Layer for ALS-related recommendation and instead supply this alternative implementation while still using the provided ALS Serving and Speed Layers.</p> 
</div> 
<div class="section"> 
 <h2 id="Creating_an_App">Creating an App</h2> 
 <p>In each case, creating a custom Batch, Speed or Serving Layer app amounts to implementing a few key Java interfaces or Scala traits in <tt>com.cloudera.oryx.api</tt>. These interfaces/traits are found in the <tt>oryx-api</tt> module within the project.</p> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="a"> 
    <th align="right"> </th> 
    <th align="left">Java </th> 
    <th align="left">Scala </th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td align="right">Batch </td> 
    <td align="left"><a class="externalLink" href="https://github.com/OryxProject/oryx/blob/master/framework/oryx-api/src/main/java/com/cloudera/oryx/api/batch/BatchLayerUpdate.java"><tt>batch.BatchLayerUpdate</tt></a> </td> 
    <td align="left"><a class="externalLink" href="https://github.com/OryxProject/oryx/blob/master/framework/oryx-api/src/main/scala/com/cloudera/oryx/api/batch/ScalaBatchLayerUpdate.scala"><tt>batch.ScalaBatchLayerUpdate</tt></a> </td> 
   </tr> 
   <tr class="a"> 
    <td align="right">Speed </td> 
    <td align="left"><a class="externalLink" href="https://github.com/OryxProject/oryx/blob/master/framework/oryx-api/src/main/java/com/cloudera/oryx/api/speed/SpeedModelManager.java"><tt>speed.SpeedModelManager</tt></a> </td> 
    <td align="left"><a class="externalLink" href="https://github.com/OryxProject/oryx/blob/master/framework/oryx-api/src/main/scala/com/cloudera/oryx/api/speed/ScalaSpeedModelManager.scala"><tt>speed.ScalaSpeedModelManager</tt></a> </td> 
   </tr> 
   <tr class="b"> 
    <td align="right">Serving </td> 
    <td align="left"><a class="externalLink" href="https://github.com/OryxProject/oryx/blob/master/framework/oryx-api/src/main/java/com/cloudera/oryx/api/serving/ServingModelManager.java"><tt>serving.ServingModelManager</tt></a> </td> 
    <td align="left"><a class="externalLink" href="https://github.com/OryxProject/oryx/blob/master/framework/oryx-api/src/main/scala/com/cloudera/oryx/api/serving/ScalaServingModelManager.scala"><tt>serving.ScalaServingModelManager</tt></a> </td> 
   </tr> 
  </tbody> 
 </table> 
 <p><tt>com.cloudera.oryx.api</tt> also contains key support classes and interfaces used by these interfaces. For example, <a class="externalLink" href="https://github.com/OryxProject/oryx/blob/master/framework/oryx-api/src/main/java/com/cloudera/oryx/api/serving/OryxResource.java"><tt>serving.OryxResource</tt></a> is a starting point for building custom JAX-RS endpoints, but need not be used.</p> 
</div> 
<div class="section"> 
 <h2 id="Building_an_App">Building an App</h2> 
 <p>To access these interfaces/traits in your application, add a dependency on <tt>com.cloudera.oryx:oryx-api</tt>. The scope should be <tt>provided</tt>.</p> 
 <p>In Maven, this would mean adding a dependency like:</p> 
 <div class="source"> 
  <div class="source"> 
   <pre>&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.cloudera.oryx&lt;/groupId&gt;
    &lt;artifactId&gt;oryx-api&lt;/artifactId&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
    &lt;version&gt;2.5.0&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;
</pre> 
  </div> 
 </div> 
 <p>A minimal skeleton project can be found at <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/example">example/</a>. In the spirit of “word count”, this application consumes lines of space-separated words, and counts the number of distinct words that each word occurs with in a line. For example, in “the quicker the better”, each word occurs with 2 other distinct words.</p> 
 <p>Compile your code and create a JAR file containing only your implementation, and any supporting third-party code. With Maven, this happens with <tt>mvn package</tt>.</p> 
 <p>Note: to enable native BLAS acceleration in your app, see additional notes about BLAS in the <a href="performance.html">performance</a> documentation.</p> 
 <div class="section"> 
  <h3 id="Compiling_the_Word_Count_Example">Compiling the Word Count Example</h3> 
  <p>Building the entire project with <tt>mvn ... package</tt> per above will actually build the example. The application JAR is produced at <tt>target/example-2.5.0.jar</tt> for example.</p> 
  <p>To rebuild or repackage just the word count example:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>cd app/example
mvn package
</pre> 
   </div> 
  </div> 
  <p>Note that this won’t work when building from the head of a branch (a <tt>SNAPSHOT</tt> version) unless you first <tt>mvn ... install</tt> the project artifacts locally.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Customizing_an_Oryx_App">Customizing an Oryx App</h2> 
 <p>When deploying the prepackaged applications that come with Oryx, in some cases, it’s possible to supply additional implementations to customize their behavior. For example, the ALS recommender application exposes a <tt>com.cloudera.oryx.app.als.RescorerProvider</tt> interface. These app-specific API classes are found in module <tt>oryx-app-api</tt>. Implementations of interfaces like these can be compiled, packaged and deployed in the same way described here for stand-alone applications.</p> 
 <div class="source"> 
  <div class="source"> 
   <pre>&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.cloudera.oryx&lt;/groupId&gt;
    &lt;artifactId&gt;oryx-app-api&lt;/artifactId&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
    &lt;version&gt;2.5.0&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;
</pre> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Deploying_an_App">Deploying an App</h2> 
 <p>Copy the resulting JAR file – call it <tt>myapp.jar</tt> – to the directory containing the Oryx binary JAR file it will be run with.</p> 
 <p>Change your Oryx <tt>.conf</tt> file to refer to your custom Batch, Speed or Serving implementation class, as appropriate.</p> 
 <p>When running the Batch / Speed / Serving Layers, add <tt>--app-jar myapp.jar</tt> to the <tt>oryx-run.sh</tt> command line.</p> 
 <div class="section"> 
  <h3 id="aDeploying_the_Word_Count_Example">&nbsp;Deploying the Word Count Example</h3> 
  <p>For example, if you’ve built the packaged example “word count” app above, you can run it by copying and adapting the provided <a class="externalLink" href="https://github.com/OryxProject/oryx/tree/master/app/conf/wordcount-example.conf"><tt>wordcount-example.conf</tt></a> configuration file:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>./oryx-run.sh batch --conf wordcount-example.conf --app-jar example-2.5.0.jar
</pre> 
   </div> 
  </div> 
  <p>… and similarly for the speed and serving layers. Feed lines of input and then observe counts:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>curl -X POST http://.../add/foo%20bar%20baz
...
curl http://.../distinct
{&quot;foo&quot;:2,&quot;bar&quot;:2,&quot;baz&quot;:2}
</pre> 
   </div> 
  </div> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#building_from_source" title="Building from Source">Building from Source <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Requirements" title="Requirements">Requirements</a>
		<li class="dropdown"><a href="#Building" title="Building">Building <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Platform_Only" title="Platform Only">Platform Only</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#Testing" title="Testing">Testing</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#module_mapping" title="Module Mapping">Module Mapping</a>
		<li class="dropdown"><a href="#making_an_oryx_app" title="Making an Oryx App">Making an Oryx App <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Creating_an_App" title="Creating an App">Creating an App</a>
		<li class="dropdown"><a href="#Building_an_App" title="Building an App">Building an App <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Compiling_the_Word_Count_Example" title="Compiling the Word Count Example">Compiling the Word Count Example</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#Customizing_an_Oryx_App" title="Customizing an Oryx App">Customizing an Oryx App</a>
		<li class="dropdown"><a href="#Deploying_an_App" title="Deploying an App">Deploying an App <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#aDeploying_the_Word_Count_Example" title=" Deploying the Word Count Example"> Deploying the Word Count Example</a>
				<li class="divider"></li>
			</ul>
		</li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span9 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014-2017. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/reflow-scroll.js"></script>

	<script src="../js/reflow-skin.js"></script>

	</body>
</html>
